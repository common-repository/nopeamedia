!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=17)}([function(module,exports){module.exports=function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}},function(module,exports){module.exports=function(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}},,function(module,exports){function _getPrototypeOf(o){return module.exports=_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}module.exports=_getPrototypeOf},function(module,exports){module.exports=function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}},function(module,exports){function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}module.exports=function(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}},function(module,exports,__webpack_require__){var superPropBase=__webpack_require__(9);function _get(target,property,receiver){return"undefined"!=typeof Reflect&&Reflect.get?module.exports=_get=Reflect.get:module.exports=_get=function(target,property,receiver){var base=superPropBase(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}},_get(target,property,receiver||target)}module.exports=_get},function(module,exports,__webpack_require__){var setPrototypeOf=__webpack_require__(10);module.exports=function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&setPrototypeOf(subClass,superClass)}},function(module,exports,__webpack_require__){var _typeof=__webpack_require__(11),assertThisInitialized=__webpack_require__(0);module.exports=function(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?assertThisInitialized(self):call}},function(module,exports,__webpack_require__){var getPrototypeOf=__webpack_require__(3);module.exports=function(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=getPrototypeOf(object)););return object}},function(module,exports){function _setPrototypeOf(o,p){return module.exports=_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}module.exports=_setPrototypeOf},function(module,exports){function _typeof(obj){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?module.exports=_typeof=function(obj){return typeof obj}:module.exports=_typeof=function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}module.exports=_typeof},function(module,exports){module.exports=React},,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var classCallCheck=__webpack_require__(4),classCallCheck_default=__webpack_require__.n(classCallCheck),createClass=__webpack_require__(5),createClass_default=__webpack_require__.n(createClass),assertThisInitialized=__webpack_require__(0),assertThisInitialized_default=__webpack_require__.n(assertThisInitialized),get=__webpack_require__(6),get_default=__webpack_require__.n(get),inherits=__webpack_require__(7),inherits_default=__webpack_require__.n(inherits),possibleConstructorReturn=__webpack_require__(8),possibleConstructorReturn_default=__webpack_require__.n(possibleConstructorReturn),getPrototypeOf=__webpack_require__(3),getPrototypeOf_default=__webpack_require__.n(getPrototypeOf),defineProperty=__webpack_require__(1),defineProperty_default=__webpack_require__.n(defineProperty),external_React_=__webpack_require__(12),Notices_Notice=function(){function Notice(){classCallCheck_default()(this,Notice)}return createClass_default()(Notice,null,[{key:"show",value:function(notice){var dismissold=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],dispatcher=wp.data.dispatch("core/notices");switch(notice.type){case"success":dispatcher.createSuccessNotice(notice.message,{actions:notice.action,id:"nopea-success"}),this.handleClick();break;case"error":dispatcher.createErrorNotice(notice.message,{actions:notice.action}),this.removeAll(dismissold);break;case"warning":dispatcher.createWarningNotice(notice.message,{actions:notice.action}),this.removeAll(dismissold)}}},{key:"removeAll",value:function(dismiss){if(dismiss){var notices=wp.data.select("core/notices").getNotices(),dispatcher=wp.data.dispatch("core/notices");notices.forEach((function(notice){"SAVE_POST_NOTICE_ID"!=notice.id&&"error"!=notice.status&&dispatcher.removeNotice(notice.id)}))}}},{key:"handleClick",value:function(){var $=jQuery;$(document).ready((function(){$(".components-notice__action.is-link").on("click",(function(e){e.stopPropagation(),e.preventDefault();var link=e.target.href;link&&-1!==link.indexOf(".pdf")&&window.open(link,"_blank")}))}))}}]),Notice}(),layoutOptions_wp$components=wp.components,layoutOptions_PanelBody=layoutOptions_wp$components.PanelBody,RangeControl=(layoutOptions_wp$components.PanelRow,layoutOptions_wp$components.Button,layoutOptions_wp$components.Panel,layoutOptions_wp$components.PanelHeader,layoutOptions_wp$components.RangeControl),RadioControl=layoutOptions_wp$components.RadioControl,layoutOptions_=(layoutOptions_wp$components.BaseControl,wp.i18n.__),layoutOptions_MarginSelector=function(props){function onChangeMargin(value,type){var margins=props.margins;margins[type]=value,props.onChange(margins,"margin")}return Object(external_React_.createElement)("div",null,Object(external_React_.createElement)(RangeControl,{label:layoutOptions_("Left margin","nopea-media"),value:props.margins.left,min:"0",max:"50",onChange:function(event){return onChangeMargin(event,"left")}}),Object(external_React_.createElement)(RangeControl,{label:layoutOptions_("Top margin","nopea-media"),value:props.margins.top,min:"0",max:"100",onChange:function(event){return onChangeMargin(event,"top")}}),Object(external_React_.createElement)(RangeControl,{label:layoutOptions_("Right margin","nopea-media"),value:props.margins.right,min:"0",max:"50",onChange:function(event){return onChangeMargin(event,"right")}}),Object(external_React_.createElement)(RangeControl,{label:layoutOptions_("Bottom margin","nopea-media"),value:props.margins.bottom,min:"0",max:"50",onChange:function(event){return onChangeMargin(event,"bottom")}}))},layoutOptions_Options=function(props){var Options=Object.keys(props.options).map((function(item){if("radio"===props.options[item].type){var options=props.options[item].options.map((function(element){return{label:element.label,value:parseInt(element.value)}}));return Object(external_React_.createElement)(RadioControl,{selected:props.options[item].value,label:props.options[item].name,options:options,onChange:function(value){return props.onChange(parseInt(value),item)}})}return"range"===props.options[item].type?Object(external_React_.createElement)(RangeControl,{value:props.options[item].value,label:props.options[item].name,min:props.options[item].min,max:props.options[item].max,onChange:function(value){return props.onChange(parseInt(value),item)}}):"margin"===props.options[item].type?Object(external_React_.createElement)("div",null,Object(external_React_.createElement)(layoutOptions_MarginSelector,{margins:props.options[item].value,onChange:props.onChange})):void 0}));return Object(external_React_.createElement)("div",null,Options)},layoutOptions=function(props){var selectedTemplateParams=props.templateParameters.find((function(element){if(element.template===props.selected)return element}));return null==selectedTemplateParams?Object(external_React_.createElement)("div",null):Object(external_React_.createElement)(layoutOptions_PanelBody,{name:"pdf-lyt-body",title:layoutOptions_("PDF Layout Options","nopea-media")+" *"},Object(external_React_.createElement)(layoutOptions_Options,{options:selectedTemplateParams.parameters,onChange:props.onChange}))},LayoutSelector_wp$components=wp.components,LayoutSelector_PanelBody=LayoutSelector_wp$components.PanelBody,LayoutSelector_Panel=LayoutSelector_wp$components.Panel,LayoutSelector_RadioControl=LayoutSelector_wp$components.RadioControl,LayoutSelector=function(props){var templateSelect=props.templates.map((function(template){return{label:template.name,value:template.template}}));return Object(external_React_.createElement)(LayoutSelector_Panel,{name:"pdf-layout"},Object(external_React_.createElement)(LayoutSelector_PanelBody,{name:"pdf-lyt-body",title:props.label+" *"},Object(external_React_.createElement)(LayoutSelector_RadioControl,{selected:props.selected,options:templateSelect,onChange:props.selectTemplate})))},Publications_CheckboxControl=wp.components.CheckboxControl,Publications=function(props){var Options=props.options.map((function(item){return Object(external_React_.createElement)("div",{className:"row",style:{marginBottom:"12px"}},Object(external_React_.createElement)("div",{className:"col-md-12"},Object(external_React_.createElement)(Publications_CheckboxControl,{label:item.label,value:item.value,checked:item.selected,onChange:function(value){return props.onChange(value,item.value)}})))}));return Object(external_React_.createElement)("div",null,Options)},ThemeSelector_wp$components=wp.components,ThemeSelector_Panel=ThemeSelector_wp$components.Panel,ThemeSelector_PanelBody=ThemeSelector_wp$components.PanelBody,ThemeSelector_RadioControl=ThemeSelector_wp$components.RadioControl,ThemeSelector=function(props){var selected=props.options.filter((function(item){return 1==item.selected})).map((function(item){return item.value})).shift();return Object(external_React_.createElement)("div",null,Object(external_React_.createElement)(ThemeSelector_Panel,{name:"theme-selector"},Object(external_React_.createElement)(ThemeSelector_PanelBody,{name:"theme-selector",title:props.label+" *"},Object(external_React_.createElement)(ThemeSelector_RadioControl,{selected:selected,options:props.options,onChange:function(value){return props.onChange(value)}}))))},PdfType_wp$components=wp.components,PdfType_Panel=PdfType_wp$components.Panel,PdfType_PanelBody=PdfType_wp$components.PanelBody,PdfType_RadioControl=PdfType_wp$components.RadioControl,PdfType=function(props){return Object(external_React_.createElement)(PdfType_Panel,{name:"pdf-type"},Object(external_React_.createElement)(PdfType_PanelBody,{name:"pdf-type",title:props.label+" *"},Object(external_React_.createElement)(PdfType_RadioControl,{selected:props.selected,options:props.types,onChange:function(value){return props.onChange(value)}})))},Background_wp$components=wp.components,Background_Panel=Background_wp$components.Panel,Background_PanelBody=Background_wp$components.PanelBody,_wp$blockEditor=(Background_wp$components.PanelRow,Background_wp$components.RadioControl,Background_wp$components.CheckboxControl,Background_wp$components.Button,wp.blockEditor),MediaUpload=_wp$blockEditor.MediaUpload,MediaUploadCheck=_wp$blockEditor.MediaUploadCheck,Background_=wp.i18n.__,Background=function(props){return Object(external_React_.createElement)("div",null,Object(external_React_.createElement)(Background_Panel,{name:"background-image",title:Background_("Background Image","nopea-media")},Object(external_React_.createElement)(Background_PanelBody,{name:"background-image",title:Background_("Background Image","nopea-media")},Object(external_React_.createElement)("div",null,Object(external_React_.createElement)(MediaUploadCheck,null,Object(external_React_.createElement)(MediaUpload,{onSelect:function(media){return props.onSelect(media)},allowedTypes:"image",render:function(_ref){var open=_ref.open;return props.renderImage(open)}}))))))},PDFUpload_wp$components=wp.components,PDFUpload_Panel=PDFUpload_wp$components.Panel,PDFUpload_PanelBody=PDFUpload_wp$components.PanelBody,PDFUpload_wp$blockEditor=wp.blockEditor,PDFUpload_MediaUpload=PDFUpload_wp$blockEditor.MediaUpload,PDFUpload_MediaUploadCheck=PDFUpload_wp$blockEditor.MediaUploadCheck,PDFUpload=function(props){return Object(external_React_.createElement)("div",null,Object(external_React_.createElement)(PDFUpload_Panel,{name:"include-pdf"},Object(external_React_.createElement)(PDFUpload_PanelBody,{title:props.label},Object(external_React_.createElement)("div",null,Object(external_React_.createElement)(PDFUpload_MediaUploadCheck,null,Object(external_React_.createElement)(PDFUpload_MediaUpload,{onSelect:function(media){return props.onSelect(media)},allowedTypes:"application/pdf",render:function(_ref){var open=_ref.open;return props.render(open)}}))))))};function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=getPrototypeOf_default()(Derived);if(hasNativeReflectConstruct){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var _wp$element=wp.element,Fragment=_wp$element.Fragment,Component=_wp$element.Component,_wp$data=(_wp$element.compose,wp.data),subscribe=_wp$data.subscribe,dispatch=_wp$data.dispatch,Sidebar_select=_wp$data.select,Sidebar_=wp.i18n.__,Sidebar_SideBar=function(_Component){inherits_default()(SideBar,_Component);var _super=_createSuper(SideBar);function SideBar(props){var _this;return classCallCheck_default()(this,SideBar),_this=_super.call(this,props),defineProperty_default()(assertThisInitialized_default()(_this),"getSaveCallback",(function(elem,blockType,attr){return attr.bid||(attr.bid=Math.floor(65536*(1+Math.random())).toString(16)),elem})),defineProperty_default()(assertThisInitialized_default()(_this),"onLayoutChange",(function(value){_this.setState({layout:parseInt(value)});var state=_objectSpread({},_this.state),updateTemplate=state.templates.filter((function(element){return element.template===parseInt(value)?element.selected=!0:element.selected=!1,element}));_this.setState({templates:updateTemplate});var selectedTempalte=state.templates.find((function(template){if(!0===template.selected)return template})),DbOptions={};Object.keys(selectedTempalte.parameters).map((function(item){DbOptions[item]={value:selectedTempalte.parameters[item].value}}));_this.setState({layout_config:DbOptions})})),defineProperty_default()(assertThisInitialized_default()(_this),"onChangeParams",(function(value,name){var state=_objectSpread({},_this.state),updatedtemplate=state.templates.filter((function(template){return!0===template.selected&&(template.parameters[name].value=value),template}));_this.setState({templates:updatedtemplate});var selectedTempalte=state.templates.find((function(template){if(!0===template.selected)return template})),DbOptions={};Object.keys(selectedTempalte.parameters).map((function(item){DbOptions[item]={value:selectedTempalte.parameters[item].value}}));_this.setState({layout_config:DbOptions})})),defineProperty_default()(assertThisInitialized_default()(_this),"onPublicationChange",(function(checked,value){var update=_this.state.publications.map((function(item){return item.value===value&&(item.selected=checked),item}));_this.setState({publications:update})})),defineProperty_default()(assertThisInitialized_default()(_this),"onImageSelect",(function(media){1==_objectSpread({},_this.state).pdf_type?_this.setState({backgroundImage:media.sizes.large?media.sizes.large.url:media.url}):_this.setState({backgroundImage:media.url}),_this.setState({backgroundImageThumb:media.sizes.thumbnail.url})})),defineProperty_default()(assertThisInitialized_default()(_this),"removeImage",(function(){_this.setState({backgroundImage:!1}),_this.setState({backgroundImageThumb:!1})})),defineProperty_default()(assertThisInitialized_default()(_this),"getImageButton",(function(openEvent){var Button=wp.components.Button,__=wp.i18n.__,state=_objectSpread({},_this.state);return Object(external_React_.createElement)("div",{className:"image-container"},state.backgroundImageThumb?Object(external_React_.createElement)("div",{className:"components-responsive-wrapper"},Object(external_React_.createElement)("div",{style:{padding:"4%"}}),Object(external_React_.createElement)("img",{src:state.backgroundImageThumb,className:""})):"",Object(external_React_.createElement)("div",{className:"button-container"},Object(external_React_.createElement)(Button,{onClick:openEvent,className:"components-button is-button is-default is-large",style:{margin:"4px"}},__("Pick an image","nopea-media"))),state.backgroundImageThumb?Object(external_React_.createElement)(Button,{className:"components-button is-link is-destructive",style:{margin:"4px"},onClick:_this.removeImage},__("Remove image","nopea-media")):"")})),defineProperty_default()(assertThisInitialized_default()(_this),"onPdfTypeSelect",(function(value){_this.setState({pdf_type:parseInt(value)})})),defineProperty_default()(assertThisInitialized_default()(_this),"onPdfCheckChanged",(function(value){_this.setState({generate_pdf:value})})),defineProperty_default()(assertThisInitialized_default()(_this),"onShowFooterChanged",(function(value){_this.setState({show_footer:value})})),defineProperty_default()(assertThisInitialized_default()(_this),"onChangeTheme",(function(value){var themes=_this.state.themes.map((function(item){return item.selected=item.value===parseInt(value),item}));_this.setState({themes:themes})})),defineProperty_default()(assertThisInitialized_default()(_this),"removePdf",(function(){_this.setState({extra_pdf:!1})})),defineProperty_default()(assertThisInitialized_default()(_this),"onPdfSelected",(function(media){_this.setState({extra_pdf:{url:media.url,title:media.title}})})),defineProperty_default()(assertThisInitialized_default()(_this),"renderPdfUpload",(function(openEvent){var Button=wp.components.Button,__=wp.i18n.__,state=_objectSpread({},_this.state);return Object(external_React_.createElement)("div",{className:"image-container"},state.extra_pdf.url?Object(external_React_.createElement)("div",{className:"components-responsive-wrapper"},Object(external_React_.createElement)("div",{style:{margin:"0 90px 0 10px"}}),Object(external_React_.createElement)("div",{class:"filename"},Object(external_React_.createElement)("div",null,state.extra_pdf.title))):"",Object(external_React_.createElement)("div",{className:"button-container"},Object(external_React_.createElement)(Button,{onClick:openEvent,className:"components-button is-button is-default is-large",style:{margin:"4px"}},__("Upload PDF","nopea-media"))),state.extra_pdf.url?Object(external_React_.createElement)(Button,{className:"components-button is-link is-destructive",style:{margin:"4px"},onClick:_this.removePdf},__("Remove PDF","nopea-media")):"")})),_this.lastIsSaving=!1,_this.state={postId:!1,publications:nopmed.publications,layout:nopmed.data.layout,pdf_generated:nopmed.data.pdf_generated,publication:nopmed.data.publication_id,config:{},templates:nopmed.layouts,generate_pdf:nopmed.data.generate_pdf,show_footer:nopmed.data.show_footer,theme:nopmed.data.theme,pdf_selected_text:"",extra_pdf:nopmed.data.extra_pdf,pdfUrl:!1,pdfTitle:!1,file:{},pdf_type:nopmed.data.pdf_type,backgroundImage:!1,backgroundImageThumb:!1,backgroundColor:!1,background:nopmed.data.background,themes:nopmed.themes},_this}return createClass_default()(SideBar,[{key:"setState",value:function(stateData){get_default()(getPrototypeOf_default()(SideBar.prototype),"setState",this).call(this,stateData),dispatch("core/editor").editPost(stateData)}},{key:"componentDidMount",value:function(){subscribe(this.saveCallback.bind(this));var state=_objectSpread({},this.state),_select=Sidebar_select("core/editor"),postId=(_select.editor,(0,_select.getCurrentPostId)());this.setState({postId:postId});var publications=state.publications.map((function(item){return item.selected=!!state.publication&&state.publication.includes(item.value),item}));this.setState({publications:publications});var themes=state.themes.map((function(item){return item.selected=item.value===state.theme,item}));this.setState({themes:themes});var layout_config=nopmed.data.layout_config,selectedTemplate=state.templates.filter((function(element){return element.template===parseInt(state.layout)?(element.selected=!0,Object.keys(layout_config).map((function(item){var value=layout_config[item].value;element.parameters[item].value=isNaN(parseInt(value))?value:parseInt(value)}))):element.selected=!1,element}));this.setState({templates:selectedTemplate}),state.background.hasOwnProperty("image")&&(this.setState({backgroundImage:"false"!==state.background.image&&state.background.image}),this.setState({backgroundImageThumb:"false"!==state.background.thumbnail&&state.background.thumbnail})),state.extra_pdf.hasOwnProperty("url")&&(this.setState({pdfUrl:"false"!==state.extra_pdf.url&&state.extra_pdf.url}),this.setState({pdfTitle:"false"!==state.extra_pdf.title&&state.extra_pdf.title})),state.pdf_generated&&Notices_Notice.show({type:"success",message:"",action:[{url:state.pdf_generated,label:Sidebar_("View PDF","nopea-media")}]})}},{key:"componentDidUpdate",value:function(prevProps,prevState){prevProps!==this.props&&dispatch("core/editor").editPost({canSave:!0})}},{key:"componentWillUnmount",value:function(){}},{key:"saveCallback",value:function(){var state=_objectSpread({},this.state),_select2=Sidebar_select("core/editor"),isSavingPost=(_select2.editor,_select2.isSavingPost),isAutosavingPost=_select2.isAutosavingPost,getBlocks=(_select2.didPostSaveRequestSucceed,_select2.getBlocks),getCurrentPost=_select2.getCurrentPost,getEditedPostAttribute=_select2.getEditedPostAttribute;0==this.lastIsSaving&&isSavingPost()&&!isAutosavingPost()&&setTimeout((function(){var post=getCurrentPost();post.content="",post.layout=state.layout,post.image="",post.blocks=getBlocks().length?getBlocks():[],post.publication=state.publications.filter((function(item){return!1!==item.selected})).map((function(item){return item.value})),post.theme=state.themes.filter((function(item){return!1!==item.selected})).map((function(item){return item.value})).shift(),post.generate_pdf=state.generate_pdf,post.show_footer=state.show_footer,post.pdf_type=state.pdf_type,state.file&&(post.file=state.file.file),post.background={image:state.backgroundImage,thumbnail:state.backgroundImageThumb},post.extra_pdf=state.extra_pdf,post.layout_config=state.layout_config;var imageId=getEditedPostAttribute("featured_media"),image=Sidebar_select("core").getMedia(imageId);if(image){var imageSize=image.media_details.sizes;1==state.pdf_type?post.image=imageSize.large?imageSize.large.source_url:imageSize.medium.source_url:post.image=imageSize.full.source_url}var data={id:state.postId,post:post,action:"nm_save_post_data",nm_nonce:nopmed.nonce};wp.apiRequest({url:nopmed.ajaxurl,data:data,method:"POST",dataType:"json"}).then((function(response){if(state.generate_pdf){var _data=response.pdf;if(0==_data||_data.hasOwnProperty("error")){var message=_data.message;if("resolve"in _data.trace){var resolve=_data.trace.resolve;Notices_Notice.show({type:"error",message:resolve,action:[]})}return void Notices_Notice.show({type:"error",message:message,action:[]},!1)}Notices_Notice.show({type:"success",message:Sidebar_("PDF Generated","nopea-media"),action:[{url:_data.url,label:Sidebar_("View PDF","nopea-media")}]})}}),(function(err){}))}),1e3),this.lastIsSaving=isSavingPost()}},{key:"render",value:function(){var __=wp.i18n.__,_wp$editPost=wp.editPost,PluginSidebar=_wp$editPost.PluginSidebar,PluginSidebarMoreMenuItem=_wp$editPost.PluginSidebarMoreMenuItem,_wp$components=wp.components,PanelBody=_wp$components.PanelBody,PanelRow=_wp$components.PanelRow,Panel=_wp$components.Panel,CheckboxControl=_wp$components.CheckboxControl;return Object(external_React_.createElement)(Fragment,null,Object(external_React_.createElement)(PluginSidebarMoreMenuItem,{name:"pdf-options",type:"sidebar",target:"pdf-options"},__("Nopea.media","nopea-media")),Object(external_React_.createElement)(PluginSidebar,{name:"nopea-media",title:__("Nopea.media","nopea-media")},Object(external_React_.createElement)(Panel,{name:"pdf-preview"},Object(external_React_.createElement)(PanelBody,null,Object(external_React_.createElement)(PanelRow,null,Object(external_React_.createElement)(CheckboxControl,{label:__("Generate PDF","nopea-media"),value:"1",checked:this.state.generate_pdf,onChange:this.onPdfCheckChanged})),Object(external_React_.createElement)(PanelRow,null,Object(external_React_.createElement)(CheckboxControl,{label:__("Show Footer","nopea-media"),value:"1",checked:this.state.show_footer,onChange:this.onShowFooterChanged})))),Object(external_React_.createElement)(PdfType,{selected:this.state.pdf_type,onChange:this.onPdfTypeSelect,label:__("PDF Quality","nopea-media"),types:[{label:__("Web","nopea-media"),value:1},{label:__("Print (Pro)","nopea-media"),value:2}]}),Object(external_React_.createElement)(PDFUpload,{render:this.renderPdfUpload,onSelect:this.onPdfSelected,label:__("Add PDF Page","nopea-media")}),Object(external_React_.createElement)(Panel,{name:"pdf-layout"},Object(external_React_.createElement)(LayoutSelector,{templates:this.state.templates,selectTemplate:this.onLayoutChange,selected:this.state.layout,label:__("Heading position","nopea-media")}),Object(external_React_.createElement)(layoutOptions,{selected:this.state.layout,templateParameters:this.state.templates,onChange:this.onChangeParams}),Object(external_React_.createElement)(ThemeSelector,{options:this.state.themes,onChange:this.onChangeTheme,label:__("Select theme","nopea-media")})),Object(external_React_.createElement)(Background,{data:this.state,renderImage:this.getImageButton,onSelect:this.onImageSelect}),Object(external_React_.createElement)(Panel,{name:"pdf-publications"},Object(external_React_.createElement)(PanelBody,{name:"publications",title:__("Publications","nopea-media")},Object(external_React_.createElement)(PanelRow,null,Object(external_React_.createElement)(Publications,{options:this.state.publications,onChange:this.onPublicationChange}))))))}}],[{key:"cleanData",value:function(blocks){var _step,newBlocks=[],_iterator=_createForOfIteratorHelper(blocks);try{for(_iterator.s();!(_step=_iterator.n()).done;){var block=_step.value,blockName=block.name.replace("/","-");newBlocks.push({uid:block.uid||block.clientId,name:block.name,data:wp.hooks.applyFilters("clean_data_".concat(blockName),block.attributes,block.name,block.innerBlocks)})}}catch(err){_iterator.e(err)}finally{_iterator.f()}return newBlocks}}]),SideBar}(Component);document.addEventListener("DOMContentLoaded",(function(){var render=Sidebar_SideBar;wp.plugins.registerPlugin("pdf-options",{icon:"media-document",render:render})}))}]);